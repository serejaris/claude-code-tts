üá¨üáß [English version](README.md)

# Claude Code TTS Hook

ASMR-—Å—Ç–∏–ª—å —Å–∏–Ω—Ç–µ–∑ —Ç–µ–∫—Å—Ç–∞ –≤ —Ä–µ—á—å –¥–ª—è Claude Code, —á–∏—Ç–∞—é—â–∏–π –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ —Å –ø–æ–º–æ—â—å—é Google Gemini.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart TB
    subgraph "Claude Code"
        CC["Claude Code<br/>Stop Hook"]
    end

    subgraph "Local Processing"
        Python["Python Script<br/>speak.py"]
        Cache["TTS Cache<br/>~/.claude/tts_cache/"]
    end

    subgraph "Google Gemini APIs"
        Flash["Gemini 2.0 Flash<br/>Summarization"]
        TTS["Gemini 2.5 Flash<br/>Text-to-Speech"]
    end

    subgraph "Output"
        Audio["Audio Playback<br/>afplay/paplay/mpv"]
    end

    CC -->|passes transcript_path| Python
    Python -->|extract last message| CC
    Python -->|summarize with ASMR prompt| Flash
    Flash -->|returns summary| Python
    Python -->|check cache| Cache
    Python -->|cache miss: synthesize| TTS
    TTS -->|returns WAV bytes| Python
    Python -->|save WAV| Cache
    Python -->|play async| Audio
```

## –û–ø–∏—Å–∞–Ω–∏–µ

–ö–æ–≥–¥–∞ —Å–µ—Å—Å–∏—è Claude Code –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è, —ç—Ç–æ—Ç —Ö—É–∫:
1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞
2. –†–µ–∑—é–º–∏—Ä—É–µ—Ç –µ–≥–æ —Å ASMR-–¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å –ø–æ–º–æ—â—å—é Gemini Flash
3. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ —Ä–µ—á—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Gemini TTS —Å –≥–æ–ª–æ—Å–æ–º "Aoede"
4. –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å–∏–Ω—Ç–µ–∑–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
5. –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∞—É–¥–∏–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–µ–∂–Ω–æ–≥–æ, –Ω–µ–∏–Ω—Ç—Ä—É–∑–∏–≤–Ω–æ–≥–æ —Ä–µ–∑—é–º–µ —Ç–æ–≥–æ, —á—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –≤–æ –≤—Ä–µ–º—è –≤–∞—à–µ–π —Å–µ—Å—Å–∏–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.7+
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `GEMINI_API_KEY` —Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∫–ª—é—á–æ–º API Google Generative AI
- macOS (afplay), Linux (paplay/aplay/mpv) –∏–ª–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä—É–π –∏–ª–∏ —Å–∫–∞—á–∞–π —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/serejaris/claude-code-tts.git
# –∏–ª–∏ —Å–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏ API –∫–ª—é—á

```bash
export GEMINI_API_KEY="your-api-key-here"
```

–î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ–±–∞–≤—å –≤ –∫–æ–Ω—Ñ–∏–≥ –æ–±–æ–ª–æ—á–∫–∏ (`~/.zshrc`, `~/.bashrc` –∏ —Ç.–¥.):

```bash
export GEMINI_API_KEY="your-api-key-here"
```

### 3. –ù–∞—Å—Ç—Ä–æ–π Claude Code

–î–æ–±–∞–≤—å –≤ `~/.claude/settings.json`:

```json
{
  "hooks": {
    "on_stop": [
      {
        "type": "command",
        "command": "python3 /path/to/claude-code-tts-hook/speak.py",
        "stdin": "json",
        "timeout": 120
      }
    ]
  }
}
```

–ó–∞–º–µ–Ω–∏ `/path/to/claude-code-tts-hook` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å, –≥–¥–µ —Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª —Ö—É–∫.

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ–ª–æ—Å–∞

–•—É–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ–ª–æ—Å "Aoede" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Å–ø–æ–∫–æ–π–Ω—ã–π, –Ω–µ–∂–Ω—ã–π, ASMR-–¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π). –¢—ã –º–æ–∂–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `VOICE` –≤ `speak.py` –Ω–∞ –ª—é–±–æ–π –∏–∑ —ç—Ç–∏—Ö:

- **Aoede** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –°–ø–æ–∫–æ–π–Ω—ã–π –∏ –Ω–µ–∂–Ω—ã–π
- **Puck** - –Ø—Ä–∫–∏–π –∏ –∏–≥—Ä–∏–≤—ã–π
- **Kore** - –¢–µ–ø–ª—ã–π –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π
- **Charon** - –ì–ª—É–±–æ–∫–∏–π –∏ –∑–∞–¥—É–º—á–∏–≤—ã–π
- **Fenrir** - –°–∏–ª—å–Ω—ã–π –∏ —É–≤–µ—Ä–µ–Ω–Ω—ã–π
- **Leda** - –ú—è–≥–∫–∏–π –∏ —É—Å–ø–æ–∫–∞–∏–≤–∞—é—â–∏–π
- **Orus** - –ß–µ—Ç–∫–∏–π –∏ –æ—Ç—á–µ—Ç–ª–∏–≤—ã–π
- **Zephyr** - –õ–µ–≥–∫–∏–π –∏ —Å–≤–µ–∂–∏–π

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `VOICE` –≤ –Ω–∞—á–∞–ª–µ `speak.py`:

```python
VOICE = "Aoede"  # –ò–∑–º–µ–Ω–∏ –Ω–∞ –ª—é–±–æ–π –≥–æ–ª–æ—Å –≤—ã—à–µ
```

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∞—É–¥–∏–æ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –≤ `~/.claude/tts_cache/` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MD5 —Ö–µ—à–∞ —Ç–µ–∫—Å—Ç–∞ –∏ –∏–º–µ–Ω–∏ –≥–æ–ª–æ—Å–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

- –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—é–º–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–∏–Ω—Ç–µ–∑–∏—Ä—É—é—Ç—Å—è –¥–≤–∞–∂–¥—ã
- –ö—ç—à —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
- –ö–∞–∂–¥—ã–π –≥–æ–ª–æ—Å –∏–º–µ–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∫—ç—à–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–±–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª–∏—Ç—å `~/.claude/tts_cache/` –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç)

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –§–æ—Ä–º–∞—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞

–•—É–∫ —á–∏—Ç–∞–µ—Ç JSONL-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:

```json
{"type": "assistant", "message": {"content": [{"type": "text", "text": "..."}]}}
```

### ASMR —Ä–µ–∑—é–º–∏—Ä–æ–≤–∞–Ω–∏–µ

–•—É–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Gemini Flash –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –Ω–µ–∂–Ω—ã–µ ASMR-—Å—Ç–∏–ª—å —Ä–µ–∑—é–º–µ:

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** "Fixed the authentication bug in auth.py line 42, updated config files"
**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:** "Fixed the auth bug for you... config is updated"

–†–µ–∑—é–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–º—ã—Å–ª, —É–±–∏—Ä–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –∏ –ø—É—Ç–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏.

### –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ

–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ –Ω–æ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ, –ø–æ—ç—Ç–æ–º—É Claude Code –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å—Ä–∞–∑—É –∂–µ, –Ω–µ –æ–∂–∏–¥–∞—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ.

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "Summary error" –∏–ª–∏ "TTS error" –≤ stderr

–≠—Ç–æ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è:
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç API –∫–ª—é—á ‚Üí –∞—É–¥–∏–æ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è
- –¢–∞–π–º–∞—É—Ç —Å–µ—Ç–∏ ‚Üí —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ–µ —Ä–µ–∑—é–º–µ –∏–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
- –û—à–∏–±–∫–∏ API ‚Üí –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ stderr, —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É

### –ê—É–¥–∏–æ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ —Å–∏—Å—Ç–µ–º–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ–¥–∏–Ω –∏–∑ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –∞—É–¥–∏–æ–ø–ª–µ–µ—Ä–æ–≤:
- macOS: `afplay` (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)
- Linux: `paplay` (PulseAudio), `aplay` (ALSA), –∏–ª–∏ `mpv` (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ package manager)

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∫—ç—à–µ–º

–û—á–∏—Å—Ç–∏ –∫—ç—à –∏ –ø–æ–≤—Ç–æ—Ä–∏ –ø–æ–ø—ã—Ç–∫—É:

```bash
rm -rf ~/.claude/tts_cache/
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `GEMINI_API_KEY` (—Ç—Ä–µ–±—É–µ—Ç—Å—è) - –¢–≤–æ–π –∫–ª—é—á API Google Generative AI
- `VOICE` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–µ—Ä–µ–∑ speak.py) - –ò–º—è –≥–æ–ª–æ—Å–∞ –¥–ª—è TTS

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
